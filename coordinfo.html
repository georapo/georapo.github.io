<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  margin: 0;
  padding: 0;
  background-image: url("bgimage.png");
  background-size: cover;
  background-position: center;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  touch-action: manipulation;
}

#main_body {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 400px;
  padding: 20px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

label {
  display: block;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #333;
}

#page {
  width: 100%;
  height: 50px;
  font-size: 24px;
  padding: 10px 15px;
  border: 2px solid #4CAF50;
  border-radius: 8px;
  text-align: center;
  text-transform: uppercase;
  margin-bottom: 15px;
}

.button {
  width: 100%;
  height: 55px;
  font-size: 20px;
  font-weight: 600;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-bottom: 12px;
  transition: all 0.2s;
}

#gosubmit {
  background: #4CAF50;
  color: white;
}

#gosubmit:active {
  background: #45a049;
  transform: scale(0.98);
}

#gosubmit_gcfi {
  background: #2196F3;
  color: white;
}

#gosubmit_gcfi:active {
  background: #0b7dda;
  transform: scale(0.98);
}

.clipboard-status {
  text-align: center;
  font-size: 14px;
  color: #666;
  margin-top: 10px;
  min-height: 20px;
}
</style>
</head>
<body onload="focustothis()">

<div id="main_body">
  <label>coord.info/GC</label>
  <input type="text" id="page" name="page" inputmode="text" autocomplete="off" autocapitalize="characters">
  <button id="gosubmit" class="button">Geocaching.com</button>
  <button id="gosubmit_gcfi" class="button">geocache.fi</button>
  <div class="clipboard-status" id="status"></div>
</div>

<script>
function parsePage() {
  let page = document.getElementById('page').value.trim().toUpperCase();
  page = page.startsWith("GC") ? page.slice(2) : page;
  return page;
}

function goToPage_gccom() {
  const page = parsePage();
  if (page) {
    window.location = "https://coord.info/GC" + page;
  }
}

function goToPage_gcfi() {
  const page = parsePage();
  if (page) {
    window.location = "https://www.geocache.fi/caches/cachetieto.php?wp=GC" + page;
  }
}

function focustothis() {
  const input = document.getElementById("page");
  const status = document.getElementById("status");
  
  try {
    const text = await navigator.clipboard.readText();
    const trimmed = text.trim();
    
    if (trimmed && trimmed.length <= 7) {
      input.value = trimmed;
      status.textContent = "✓ Tuotu leikepöydältä";
      setTimeout(() => status.textContent = "", 2000);
    }
  } catch (err) {
    //console.log('Clipboard read not available');
	  status.textContent = "Leikepöydältä ei löytynyt sisältöä";
      setTimeout(() => status.textContent = "", 2000);
  }
  
  input.focus();
  
  setTimeout(() => {
    input.focus();
    const len = input.value.length;
    input.setSelectionRange(len, len);
  }, 1000);
}

// Enter key support
document.getElementById('page').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    goToPage_gccom();
  }
});

// Button click handlers
document.getElementById('gosubmit').addEventListener('click', goToPage_gccom);
document.getElementById('gosubmit_gcfi').addEventListener('click', goToPage_gcfi);

// Initialize on page load
document.addEventListener('DOMContentLoaded', focustothis);

// Refocus when page becomes visible (for mobile browser switching)
document.addEventListener('visibilitychange', function() {
  if (!document.hidden) {
    setTimeout(focustothis, 1000);
  }
});
</script>
</body>
</html>